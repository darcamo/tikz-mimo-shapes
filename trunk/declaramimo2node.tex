%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Modified from the example in
% http://www.texample.net/tikz/examples/d-flip-flops-and-shift-register/
\makeatletter


\newif\ifleftantennas

% The keys that the user can provide are:
%   "right antennas" (default if not provided)
%   "left antennas"
%   "antenna offset=some value" (default is 0.3cm)
\pgfkeys{
  /mimonode/leftantennas/.is if=leftantennas,
  /pgf/.cd,
  right antennas/.code={\pgfkeys{/mimonode/leftantennas=false}},
  left antennas/.code={\pgfkeys{/mimonode/leftantennas=true}},
  minimum width/.initial=1.5cm,
  minimum height/.initial=2cm,
  antenna offset/.initial=0.3
}

% Macro with the common code to draw an antenna. Before calling this macro
% (inside the backgroundpath or similar)you need to set the values of
% \pgf@x and \pgf@y to point to the start of the antenna. 
\def\drawantenna{
  % Store the current positions
  \pgf@xa=\pgf@x \pgf@ya=\pgf@y
  \pgfpathmoveto{\pgfpoint{\pgf@x}{\pgf@y}}

  \advance\pgf@xa by \antennaoffset cm
  \pgfpathlineto{\pgfpoint{\pgf@xa}{\pgf@ya}}
  \pgfpathclose
  \pgfmoveto{\pgfpoint{\pgf@xa}{\pgf@ya}}

  \pgf@xb=\pgf@xa \pgf@yb=\pgf@ya
  \advance\pgf@yb by 0.2cm
  \pgfpathlineto{\pgfpoint{\pgf@xb}{\pgf@yb}}
  
  \pgf@xc=\pgf@xb \pgf@yc=\pgf@yb
  \advance\pgf@xc by 0.2cm
  \advance\pgf@yc by 0.3cm
  \pgfpathlineto{\pgfpoint{\pgf@xc}{\pgf@yc}}

  \pgf@xa=\pgf@xc \pgf@ya=\pgf@yc
  \advance\pgf@xa by -0.4cm
  \pgfpathlineto{\pgfpoint{\pgf@xa}{\pgf@ya}}
  
  \pgf@xb=\pgf@xa \pgf@yb=\pgf@ya
  \advance\pgf@xb by 0.2cm
  \advance\pgf@yb by -0.3cm
  \pgfpathlineto{\pgfpoint{\pgf@xb}{\pgf@yb}}
}
% xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx


% xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
% xxxxxxxxxxxxxxx mimodois shape declaration xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
% xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
\pgfdeclareshape{mimodois}{
  \savedmacro\antennaoffset{
    \ifleftantennas
      \def\antennaoffset{-\pgfkeysvalueof{/pgf/antenna offset}}
    \else
      \def\antennaoffset{\pgfkeysvalueof{/pgf/antenna offset}}
    \fi
  }

  \savedmacro\shapewidth{
    \def\shapewidth{\pgfkeysvalueof{/pgf/minimum width}}
    }

    \savedmacro\shapeheight{
      \def\shapeheight{\pgfkeysvalueof{/pgf/minimum height}}
    }


  % Inherit saved anchor from rectangle (\northeast and \southwest)
    %\inheritsavedanchors[from=rectangle]
  \savedanchor\northeast{%
    \pgf@y=.5\ht\pgfnodeparttextbox % height of the box, ignoring the depth
    \pgf@x=.5\wd\pgfnodeparttextbox % width of the box
    \setlength{\pgf@xa}{\shapewidth}
    \ifdim\pgf@x<.5\pgf@xa
    \pgf@x=.5\pgf@xa
    \fi
    \setlength{\pgf@ya}{\shapeheight}
    \ifdim\pgf@y<.5\pgf@ya
    \pgf@y=.5\pgf@ya
    \fi
  }
  % This is redundant, but makes some things easier:
  \savedanchor\southwest{%
    % \pgf@x=\xmin
    % \pgf@y=\ymin
    \pgf@y=-.5\ht\pgfnodeparttextbox % height of the box, ignoring the depth
    \pgf@x=-.5\wd\pgfnodeparttextbox % width of the box
    \setlength{\pgf@xa}{-\shapewidth}
    \ifdim\pgf@x>.5\pgf@xa
    \pgf@x=.5\pgf@xa
    \fi
    \setlength{\pgf@ya}{-\shapeheight}
    \ifdim\pgf@y>.5\pgf@ya
    \pgf@y=.5\pgf@ya
    \fi
  }

  % This anchor position will depend if the "left antennas" option was
  % passed or not
  \savedanchor{\anchorA}{
    % y position for the first antenna
    \pgf@y=.5\ht\pgfnodeparttextbox
    \setlength{\pgf@ya}{\pgfshapeminheight}
    \ifdim\pgf@y<.5\pgf@ya
    \pgf@y=.5\pgf@ya
    \fi
    \pgf@y=0.4\pgf@y
    %
    % x position
    \ifleftantennas
      % Anchor position when the "left antennas" key is used
      \pgf@x=-.5\wd\pgfnodeparttextbox
      \setlength{\pgf@xa}{-\pgfshapeminwidth}
      \ifdim\pgf@x>.5\pgf@xa
      \pgf@x=.5\pgf@xa
      \fi
    \else
      % Anchor position when the "left antennas" key is not used or when
      % the "right antennas" key is used.
      \pgf@x=.5\wd\pgfnodeparttextbox % width of the box
      \setlength{\pgf@xa}{\pgfshapeminwidth}
      \ifdim\pgf@x<.5\pgf@xa
      \pgf@x=.5\pgf@xa
      \fi
    \fi
  }

  % This anchor position will depend if the "left antennas" option was
  % passed or not
  \savedanchor{\anchorB}{
    % y position for the first antenna
    \pgf@y=-.5\ht\pgfnodeparttextbox
    \setlength{\pgf@ya}{-\pgfshapeminheight}
    \ifdim\pgf@y>.5\pgf@ya
    \pgf@y=.5\pgf@ya
    \fi
    \pgf@y=0.6\pgf@y
    %
    % x position
    \ifleftantennas
      % Anchor position when the "left antennas" key is used
      \pgf@x=-.5\wd\pgfnodeparttextbox
      \setlength{\pgf@xa}{-\pgfshapeminwidth}
      \ifdim\pgf@x>.5\pgf@xa
      \pgf@x=.5\pgf@xa
      \fi
    \else
      % Anchor position when the "left antennas" key is not used or when
      % the "right antennas" key is used.
      \pgf@x=.5\wd\pgfnodeparttextbox % width of the box
      \setlength{\pgf@xa}{\pgfshapeminwidth}
      \ifdim\pgf@x<.5\pgf@xa
      \pgf@x=.5\pgf@xa
      \fi
    \fi
  }
 
  \anchor{A}{\anchorA}
  \anchor{B}{\anchorB}

  % Inherit anchor border from rectangle
    \inheritanchorborder[from=rectangle]

  % Inherit normal anchors from rectangle
  % \inheritanchor[from=rectangle]{center}
    \anchor{center}{\pgfpointorigin}
  % \inheritanchor[from=rectangle]{north}
    \anchor{north}{ \northeast \pgf@x=0pt }
  % \inheritanchor[from=rectangle]{east}
    \anchor{east}{\northeast \pgf@y=0pt}
  % \inheritanchor[from=rectangle]{south}
    \anchor{south}{ \southwest \pgf@x=0pt }
  % \inheritanchor[from=rectangle]{west}
    \anchor{west}{\southwest \pgf@y=0pt}
  % \inheritanchor[from=rectangle]{north east}
    \anchor{north east}{\northeast}
  % \inheritanchor[from=rectangle]{north west}
    \anchor{north west}{\northeast \pgf@x=-\pgf@x}
  % \inheritanchor[from=rectangle]{south west}
    \anchor{south west}{\southwest}
  % \inheritanchor[from=rectangle]{south east}
    \anchor{south east}{\southwest \pgf@x=-\pgf@x}
  % \inheritanchor[from=rectangle]{text}
    \anchor{text}{
    \pgfpointorigin
    \advance\pgf@x by -.5\wd\pgfnodeparttextbox%
    \advance\pgf@y by -.5\ht\pgfnodeparttextbox%
    \advance\pgf@y by +.5\dp\pgfnodeparttextbox%
  }
  % \inheritanchor[from=rectangle]{base}
  % \inheritanchor[from=rectangle]{mid}
  % We can inheritanchor other anchors, such as "mid west", "base west",
  % etc. See the code for the rectangle shape.


  % xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
  % Define some more useful anchors
  \anchor{first antenna base start}{
    \pgf@anchor@mimodois@A
  }
  
  \anchor{second antenna base start}{
    \pgf@anchor@mimodois@B
  }

  \anchor{first antenna base end}{
    \csname pgf@anchor@mimodois@first antenna base start\endcsname
    \advance\pgf@x by \antennaoffset%
    \advance\pgf@y by 0.2cm%
  }
  \anchor{second antenna base end}{
    \csname pgf@anchor@mimodois@second antenna base start\endcsname
    \advance\pgf@x by \antennaoffset%
    \advance\pgf@y by 0.2cm%
  }

  \anchor{first antenna}{
    \csname pgf@anchor@mimodois@first antenna base start\endcsname
    \advance\pgf@x by \antennaoffset%
    \advance\pgf@y by 0.4cm%
  }
  \anchor{second antenna}{
    \csname pgf@anchor@mimodois@second antenna base start\endcsname
    \advance\pgf@x by \antennaoffset%
    \advance\pgf@y by 0.4cm%
  }

  % Draw the rectangle box and the three circles
  \backgroundpath{
    % Rectangle box
    \pgfpathrectanglecorners{\southwest}{\northeast}

    % Delete the two lines below (used for debugging)
    \southwest
    % \pgftext[top,right,at={\pgfpoint{\pgf@x}{\pgf@y}}]{\pgfkeysvalueof{/mimonode/antennastotheleft}}

    %%%%%%% Draw the first antenna %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % \pgf@anchor@mimodois@A
    \csname pgf@anchor@\shape@name @A\endcsname
    % The drawantenna command only needs that pgf@x and pgf@y are
    % correctly set. This is set by calling the anchor A
    \drawantenna
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


    %%%%% Draw the second antenna %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \csname pgf@anchor@\shape@name @B\endcsname
    % \pgf@anchor@mimodois@B
    \drawantenna
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  }
}


% Key to add font macros to the current font
\tikzset{add font/.code={\expandafter\def\expandafter\tikz@textfont\expandafter{\tikz@textfont#1}}} 

% Define default style for this node
%\tikzset{flip flop/port labels/.style={font=\sffamily\scriptsize}}
% \tikzset{every mimodois node/.style={draw,thick,inner sep=1mm,outer sep=0pt,cap=round,add 
% font=\sffamily}}

\makeatother



% xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
% xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
% xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
% xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx




% \pgfdeclareshape{mimodoisdireita}{
%   \savedmacro\antennaoffset{
%     \ifleftantennas
%       \def\antennaoffset{-\pgfkeysvalueof{/pgf/antenna offset}}
%     \else
%       \def\antennaoffset{\pgfkeysvalueof{/pgf/antenna offset}}
%     \fi
%   }

%   \savedmacro\shapewidth{
%     \def\shapewidth{\pgfkeysvalueof{/pgf/minimum width}}
%     }

%     \savedmacro\shapeheight{
%       \def\shapeheight{\pgfkeysvalueof{/pgf/minimum height}}
%     }


%   % Inherit saved anchor from rectangle (\northeast and \southwest)
%     %\inheritsavedanchors[from=rectangle]
%   \savedanchor\northeast{%
%     % \pgf@x=\xmax
%     % \pgf@y=\ymax
%     \pgf@y=.5\ht\pgfnodeparttextbox % height of the box, ignoring the depth
%     \pgf@x=.5\wd\pgfnodeparttextbox % width of the box
%     \setlength{\pgf@xa}{\shapewidth}
%     \ifdim\pgf@x<.5\pgf@xa
%     \pgf@x=.5\pgf@xa
%     \fi
%     \setlength{\pgf@ya}{\shapeheight}
%     \ifdim\pgf@y<.5\pgf@ya
%     \pgf@y=.5\pgf@ya
%     \fi
%   }
%   % This is redundant, but makes some things easier:
%   \savedanchor\southwest{%
%     % \pgf@x=\xmin
%     % \pgf@y=\ymin
%     \pgf@y=-.5\ht\pgfnodeparttextbox % height of the box, ignoring the depth
%     \pgf@x=-.5\wd\pgfnodeparttextbox % width of the box
%     \setlength{\pgf@xa}{-\shapewidth}
%     \ifdim\pgf@x>.5\pgf@xa
%     \pgf@x=.5\pgf@xa
%     \fi
%     \setlength{\pgf@ya}{-\shapeheight}
%     \ifdim\pgf@y>.5\pgf@ya
%     \pgf@y=.5\pgf@ya
%     \fi
%   }

%   % This anchor position will depend if the "left antennas" option was
%   % passed or not
%   \savedanchor{\anchorA}{
%     % y position for the first antenna
%     \pgf@y=.5\ht\pgfnodeparttextbox
%     \setlength{\pgf@ya}{\pgfshapeminheight}
%     \ifdim\pgf@y<.5\pgf@ya
%     \pgf@y=.5\pgf@ya
%     \fi
%     \pgf@y=0.4\pgf@y
%     %
%     % x position
%     \ifleftantennas
%       % Anchor position when the "left antennas" key is used
%       \pgf@x=-.5\wd\pgfnodeparttextbox
%       \setlength{\pgf@xa}{-\pgfshapeminwidth}
%       \ifdim\pgf@x>.5\pgf@xa
%       \pgf@x=.5\pgf@xa
%       \fi
%     \else
%       % Anchor position when the "left antennas" key is not used or when
%       % the "right antennas" key is used.
%       \pgf@x=.5\wd\pgfnodeparttextbox % width of the box
%       \setlength{\pgf@xa}{\pgfshapeminwidth}
%       \ifdim\pgf@x<.5\pgf@xa
%       \pgf@x=.5\pgf@xa
%       \fi
%     \fi
%   }

%   % This anchor position will depend if the "left antennas" option was
%   % passed or not
%   \savedanchor{\anchorB}{
%     % y position for the first antenna
%     \pgf@y=-.5\ht\pgfnodeparttextbox
%     \setlength{\pgf@ya}{-\pgfshapeminheight}
%     \ifdim\pgf@y>.5\pgf@ya
%     \pgf@y=.5\pgf@ya
%     \fi
%     \pgf@y=0.6\pgf@y
%     %
%     % x position
%     \ifleftantennas
%       % Anchor position when the "left antennas" key is used
%       \pgf@x=-.5\wd\pgfnodeparttextbox
%       \setlength{\pgf@xa}{-\pgfshapeminwidth}
%       \ifdim\pgf@x>.5\pgf@xa
%       \pgf@x=.5\pgf@xa
%       \fi
%     \else
%       % Anchor position when the "left antennas" key is not used or when
%       % the "right antennas" key is used.
%       \pgf@x=.5\wd\pgfnodeparttextbox % width of the box
%       \setlength{\pgf@xa}{\pgfshapeminwidth}
%       \ifdim\pgf@x<.5\pgf@xa
%       \pgf@x=.5\pgf@xa
%       \fi
%     \fi
%   }
 
%   \anchor{A}{\anchorA}
%   \anchor{B}{\anchorB}

%   % Inherit anchor border from rectangle
%     \inheritanchorborder[from=rectangle]

%   % Inherit normal anchors from rectangle
%   % \inheritanchor[from=rectangle]{center}
%     \anchor{center}{\pgfpointorigin}
%   % \inheritanchor[from=rectangle]{north}
%     \anchor{north}{ \northeast \pgf@x=0pt }
%   % \inheritanchor[from=rectangle]{east}
%     \anchor{east}{\northeast \pgf@y=0pt}
%   % \inheritanchor[from=rectangle]{south}
%     \anchor{south}{ \southwest \pgf@x=0pt }
%   % \inheritanchor[from=rectangle]{west}
%     \anchor{west}{\southwest \pgf@y=0pt}
%   % \inheritanchor[from=rectangle]{north east}
%     \anchor{north east}{\northeast}
%   % \inheritanchor[from=rectangle]{north west}
%     \anchor{north west}{\northeast \pgf@x=-\pgf@x}
%   % \inheritanchor[from=rectangle]{south west}
%     \anchor{south west}{\southwest}
%   % \inheritanchor[from=rectangle]{south east}
%     \anchor{south east}{\southwest \pgf@x=-\pgf@x}
%   % \inheritanchor[from=rectangle]{text}
%     \anchor{text}{
%     \pgfpointorigin
%     \advance\pgf@x by -.5\wd\pgfnodeparttextbox%
%     \advance\pgf@y by -.5\ht\pgfnodeparttextbox%
%     \advance\pgf@y by +.5\dp\pgfnodeparttextbox%
%   }
%   % \inheritanchor[from=rectangle]{base}
%   % \inheritanchor[from=rectangle]{mid}
%   % We can inheritanchor other anchors, such as "mid west", "base west",
%   % etc. See the code for the rectangle shape.


%   % % Define anchors for the start of the antennas
%   % \anchor{A}{
%   %   \ifleftantennas
%   %     % Anchor position when the "left antennas" key is used
%   %     \pgf@process{\northeast}%
%   %     \pgf@ya=\pgf@y
%   %     \pgf@process{\southwest}%
%   %     \pgf@y=0.4\pgf@ya
%   %   \else
%   %     % Anchor position when the "left antennas" key is not used or when
%   %     % the "right antennas" key is used.
%   %     \pgf@process{\northeast}%
%   %     % \pgf@x=0\pgf@x%
%   %     \pgf@y=0.4\pgf@y%
%   %   \fi
%   % }

%   % \anchor{B}{
%   %   \ifleftantennas
%   %     \pgf@process{\southwest}%
%   %     \pgf@y=0.6\pgf@y%
%   %   \else
%   %     \pgf@process{\northeast}%
%   %     \pgf@xa=\pgf@x
%   %     \pgf@process{\southwest}%
%   %     \pgf@x=\pgf@xa%
%   %     \pgf@y=0.6\pgf@y%
%   %   \fi
%   % }




%   % xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
%   % Define some more useful anchors
%   \anchor{first antenna base start}{
%     \pgf@anchor@mimodoisdireita@A
%   }
  
%   \anchor{second antenna base start}{
%     \pgf@anchor@mimodoisdireita@B
%   }

%   \anchor{first antenna base end}{
%     \csname pgf@anchor@mimodoisdireita@first antenna base start\endcsname
%     \advance\pgf@x by \antennaoffset%
%     \advance\pgf@y by 0.2cm%
%   }
%   \anchor{second antenna base end}{
%     \csname pgf@anchor@mimodoisdireita@second antenna base start\endcsname
%     \advance\pgf@x by \antennaoffset%
%     \advance\pgf@y by 0.2cm%
%   }

%   \anchor{first antenna}{
%     \csname pgf@anchor@mimodoisdireita@first antenna base start\endcsname
%     \advance\pgf@x by \antennaoffset%
%     \advance\pgf@y by 0.4cm%
%   }
%   \anchor{second antenna}{
%     \csname pgf@anchor@mimodoisdireita@second antenna base start\endcsname
%     \advance\pgf@x by \antennaoffset%
%     \advance\pgf@y by 0.4cm%
%   }

%   % Draw the rectangle box and the three circles
%   \backgroundpath{
%     % Rectangle box
%     \pgfpathrectanglecorners{\southwest}{\northeast}

%     % Delete the two lines below (used for debugging)
%     \southwest
%     %\pgftext[top,right,at={\pgfpoint{\pgf@x}{\pgf@y}}]{xmax = \xmax}
%     % \pgftext[top,right,at={\pgfpoint{\pgf@x}{\pgf@y}}]{xmin = \xmin}
%     % \pgftext[top,right,at={\pgfpoint{\pgf@x}{\pgf@y}}]{ymin = \ymin}
%     % \pgftext[top,right,at={\pgfpoint{\pgf@x}{\pgf@y}}]{\pgfkeysvalueof{/mimonode/antennastotheleft}}

%     %%%%%%% Draw the first antenna %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%     % \pgf@anchor@mimodoisdireita@A
%     \csname pgf@anchor@\shape@name @A\endcsname
%     % The drawantenna command only needs that pgf@x and pgf@y are
%     % correctly set. This is set by calling the anchor A
%     \drawantenna
%     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%     %%%%% Draw the second antenna %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%     \csname pgf@anchor@\shape@name @B\endcsname
%     % \pgf@anchor@mimodoisdireita@B
%     \drawantenna
%     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%   }
% }


% % Key to add font macros to the current font
% \tikzset{add font/.code={\expandafter\def\expandafter\tikz@textfont\expandafter{\tikz@textfont#1}}} 

% % Define default style for this node
% %\tikzset{flip flop/port labels/.style={font=\sffamily\scriptsize}}
% \tikzset{every mimodoisdireita node/.style={draw,minimum width=1.5cm,minimum 
% height=2cm,thick,inner sep=1mm,outer sep=0pt,cap=round,add 
% font=\sffamily}}

% \makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% % Modified from the example in
% % http://www.texample.net/tikz/examples/d-flip-flops-and-shift-register/
% \makeatletter

% \pgfdeclareshape{mimodoisesquerda}{
%   \savedmacro\antennaoffset{\def\antennaoffset{-\pgfkeysvalueof{/pgf/antenna offset}}}
%   % The 'minimum width' and 'minimum height' keys, not the content, determine
%   % the size

%   % Inherit saved anchor from rectangle (\northeast and \southwest)
%   \inheritsavedanchors[from=rectangle]

%   % Inherit from rectangle
%   \inheritanchorborder[from=mimodoisdireita]

%   % Inherit normal anchors from rectangle
%   \inheritanchor[from=mimodoisdireita]{center}
%   \inheritanchor[from=mimodoisdireita]{north}
%   \inheritanchor[from=mimodoisdireita]{east}
%   \inheritanchor[from=mimodoisdireita]{south}
%   \inheritanchor[from=mimodoisdireita]{west}
%   \inheritanchor[from=mimodoisdireita]{north east}
%   \inheritanchor[from=mimodoisdireita]{north west}
%   \inheritanchor[from=mimodoisdireita]{south west}
%   \inheritanchor[from=mimodoisdireita]{south east}
%   \inheritanchor[from=mimodoisdireita]{text}
%   \inheritanchor[from=mimodoisdireita]{base}
%   \inheritanchor[from=mimodoisdireita]{mid}
%   % Posso herdar outras como "mid west", "base west", etc. Veja no código do rectangle

%   % Define helper anchors
%   \anchor{A}{
%     \pgf@process{\northeast}%
%     \pgf@ya=\pgf@y
%     \pgf@process{\southwest}%
%     \pgf@y=0.4\pgf@ya
%   }

%   \anchor{B}{
%     \pgf@process{\southwest}%
%     \pgf@y=0.6\pgf@y%
%   }

%   % Define some more useful anchors
%   \anchor{first antenna base start}{\pgf@anchor@mimodoisesquerda@A}
%   \anchor{second antenna base start}{\pgf@anchor@mimodoisesquerda@B}

%   \anchor{first antenna base end}{
%     \csname pgf@anchor@mimodoisesquerda@first antenna base start\endcsname
%     \advance\pgf@x by \antennaoffset%
%     \advance\pgf@y by 0.2cm%
%   }
%   \anchor{second antenna base end}{
%     \csname pgf@anchor@mimodoisesquerda@second antenna base start\endcsname
%     \advance\pgf@x by \antennaoffset%
%     \advance\pgf@y by 0.2cm%
%   }

%   \anchor{first antenna}{
%     \csname pgf@anchor@mimodoisesquerda@first antenna base start\endcsname
%     \advance\pgf@x by \antennaoffset%
%     \advance\pgf@y by 0.4cm%
%   }
%   \anchor{second antenna}{
%     \csname pgf@anchor@mimodoisesquerda@second antenna base start\endcsname
%     \advance\pgf@x by \antennaoffset%
%     \advance\pgf@y by 0.4cm%
%   }

%   % Draw the rectangle box and the three circles
%   \inheritbackgroundpath[from=mimodoisdireita]
% }

% % Key to add font macros to the current font
% % \tikzset{add font/.code={\expandafter\def\expandafter\tikz@textfont\expandafter{\tikz@textfont#1}}} 

% % Define default style for this node
% %\tikzset{flip flop/port labels/.style={font=\sffamily\scriptsize}}
% \tikzset{every mimodoisesquerda node/.style={draw,minimum width=1.5cm,minimum 
% height=2cm,thick,inner sep=1mm,outer sep=0pt,cap=round,add 
% font=\sffamily}}

% \makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "testmimo2.tex"
%%% TeX-PDF-mode: t
%%% End: 
